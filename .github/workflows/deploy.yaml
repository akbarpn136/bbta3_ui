name: Build & Deploy BBTA3 Website

on:
  push:
    branches:
      - master

jobs:
  update_project_server1:
    runs-on: server1
    defaults:
      run:
        shell: bash
        working-directory: /var/www/bbta3/v4/
    steps:
      - name: Pull the repository
        run: |
          git version
          git pull https://github.com/bbta3-bppt/website.git

  compile_project_server1:
    runs-on: server1
    needs: update_project_server1
    defaults:
      run:
        shell: bash
        working-directory: /var/www/bbta3/v4/
    steps:
      - name: Compile website
        run: |
          hugo -v

  update_project_server4:
    runs-on: server4
    defaults:
      run:
        shell: bash
        working-directory: /var/www/bbta3/v4/
    steps:
      - name: Pull the repository
        run: |
          git version
          git pull https://github.com/bbta3-bppt/website.git

    compile_project_server4:
      runs-on: server4
      needs: update_project_server4
      defaults:
        run:
          shell: bash
          working-directory: /var/www/bbta3/v4/
      steps:
        - name: Compile website
          run: |
            hugo -v